{"paragraphs":[{"text":"%spark.pyspark\n\nimport pyspark\nfrom pyspark import SparkContext\nfrom pyspark.sql import SparkSession, Row\nfrom pyspark.sql.types import *\nfrom pyspark.sql.functions import *\nfrom pyspark.ml.classification import LogisticRegression\nfrom pyspark.ml.tuning import CrossValidator\nfrom pyspark.ml.feature import OneHotEncoderEstimator, StringIndexer, VectorAssembler\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.evaluation import BinaryClassificationEvaluator\nfrom pyspark.ml.classification import RandomForestClassifier\nfrom sklearn.metrics import classification_report, confusion_matrix\n\n","user":"anonymous","dateUpdated":"2019-12-10T01:59:20+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322816_1224906501","id":"20191208-022323_360519493","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-10T01:58:45+0000","dateFinished":"2019-12-10T01:58:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:25087"},{"text":"%spark.pyspark\n\narushi_ = spark.read.csv(\"s3://project-aaar/new_data/part-00000-f226c182-aa39-44df-a7fb-09b7ade36889-c000.csv\", header = True)\n","user":"anonymous","dateUpdated":"2019-12-09T21:21:49+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322816_-1048072180","id":"20191208-015201_802842127","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:21:49+0000","dateFinished":"2019-12-09T21:21:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25088"},{"text":"%spark.pyspark\n\narushi = arushi_","user":"anonymous","dateUpdated":"2019-12-09T21:21:50+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322817_-1870160574","id":"20191208-030446_1323338356","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:21:51+0000","dateFinished":"2019-12-09T21:21:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25089"},{"text":"%spark.pyspark\n\narushi.count()\n","user":"anonymous","dateUpdated":"2019-12-09T21:21:53+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2631171\n"}]},"apps":[],"jobName":"paragraph_1575926322817_1723402212","id":"20191208-015259_2071239722","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:21:53+0000","dateFinished":"2019-12-09T21:21:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25090"},{"text":"%spark.pyspark\n\narushi.dtypes","user":"anonymous","dateUpdated":"2019-12-09T21:21:55+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('resident_status', 'string'), ('month_of_death', 'string'), ('sex', 'string'), ('place_of_death_and_decedents_status', 'string'), ('marital_status', 'string'), ('day_of_week_of_death', 'string'), ('injury_at_work', 'string'), ('manner_of_death', 'string'), ('method_of_disposition', 'string'), ('autopsy', 'string'), ('activity_code', 'string'), ('place_of_injury_for_causes_w00_y34_except_y06_and_y07_', 'string'), ('113_cause_recode', 'string'), ('39_cause_recode', 'string'), ('race', 'string'), ('education', 'string'), ('age', 'string')]\n"}]},"apps":[],"jobName":"paragraph_1575926322817_735211771","id":"20191208-021626_1496009943","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:21:55+0000","dateFinished":"2019-12-09T21:21:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25091"},{"text":"%spark.pyspark\n\narushi.show(3)","user":"anonymous","dateUpdated":"2019-12-09T21:21:58+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------+---+-----------------------------------+--------------+--------------------+--------------+---------------+---------------------+-------+-------------+------------------------------------------------------+----------------+---------------+----+---------+------+\n|resident_status|month_of_death|sex|place_of_death_and_decedents_status|marital_status|day_of_week_of_death|injury_at_work|manner_of_death|method_of_disposition|autopsy|activity_code|place_of_injury_for_causes_w00_y34_except_y06_and_y07_|113_cause_recode|39_cause_recode|race|education|   age|\n+---------------+--------------+---+-----------------------------------+--------------+--------------------+--------------+---------------+---------------------+-------+-------------+------------------------------------------------------+----------------+---------------+----+---------+------+\n|              1|            01|  M|                                  4|             M|                   4|             U|              7|                    C|      N|         null|                                                  null|             070|             24|  01|        2|1044.0|\n|              1|            01|  M|                                  4|             D|                   3|             U|              7|                    C|      N|         null|                                                  null|             062|             21|  01|        2| 696.0|\n|              1|            01|  F|                                  4|             W|                   2|             U|              7|                    C|      N|         null|                                                  null|             086|             28|  01|        7| 900.0|\n+---------------+--------------+---+-----------------------------------+--------------+--------------------+--------------+---------------+---------------------+-------+-------------+------------------------------------------------------+----------------+---------------+----+---------+------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1575926322817_-37947142","id":"20191208-021638_2099377045","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:21:58+0000","dateFinished":"2019-12-09T21:21:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25092"},{"text":"%spark.pyspark\n\narushi = arushi.drop(\"activity_code\", \"place_of_injury_for_causes_w00_y34_except_y06_and_y07_\", \"113_cause_recode\")","user":"anonymous","dateUpdated":"2019-12-09T21:22:02+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322817_408667296","id":"20191208-021701_2058745207","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:22:02+0000","dateFinished":"2019-12-09T21:22:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25093"},{"text":"%spark.pyspark\n\narushi_nulls = arushi.select([count(when(isnan(i) | col(i).isNull(), i)).alias(i) for i in arushi.columns])\narushi_nulls.show()","user":"anonymous","dateUpdated":"2019-12-09T21:22:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------+---+-----------------------------------+--------------+--------------------+--------------+---------------+---------------------+-------+---------------+----+---------+---+\n|resident_status|month_of_death|sex|place_of_death_and_decedents_status|marital_status|day_of_week_of_death|injury_at_work|manner_of_death|method_of_disposition|autopsy|39_cause_recode|race|education|age|\n+---------------+--------------+---+-----------------------------------+--------------+--------------------+--------------+---------------+---------------------+-------+---------------+----+---------+---+\n|              0|             0|  0|                                  0|             0|                   0|             0|         364034|                    0|      0|              0|   0|     1530|  0|\n+---------------+--------------+---+-----------------------------------+--------------+--------------------+--------------+---------------+---------------------+-------+---------------+----+---------+---+\n\n"}]},"apps":[],"jobName":"paragraph_1575926322817_1722079468","id":"20191208-030409_22580319","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:22:04+0000","dateFinished":"2019-12-09T21:22:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25094"},{"text":"%spark.pyspark\n\narushi = arushi.na.fill({'education' : '9', 'manner_of_death' : '99'})","user":"anonymous","dateUpdated":"2019-12-09T21:22:12+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322817_221996300","id":"20191208-030432_1138681275","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:22:12+0000","dateFinished":"2019-12-09T21:22:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25095"},{"text":"%spark.pyspark\n\narushi = arushi.withColumn(\"age\", arushi[\"age\"].cast('float'))\narushi = arushi.where(arushi.age >= 0)\n","user":"anonymous","dateUpdated":"2019-12-09T21:22:15+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322818_-216034157","id":"20191208-021936_140979264","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:22:18+0000","dateFinished":"2019-12-09T21:22:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25096"},{"text":"%spark.pyspark\n\narushi = arushi.withColumn(\"autopsy\", upper(arushi.autopsy))","user":"anonymous","dateUpdated":"2019-12-09T21:22:21+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322818_-2028954300","id":"20191208-034243_1595949142","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:22:21+0000","dateFinished":"2019-12-09T21:22:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25097"},{"text":"%spark.pyspark\n\narushi = arushi.where(arushi.method_of_disposition.isin(['B', 'C']))","user":"anonymous","dateUpdated":"2019-12-09T21:22:24+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322818_1015350104","id":"20191209-023222_616934466","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:22:24+0000","dateFinished":"2019-12-09T21:22:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25098"},{"text":"%spark.pyspark\n\narushi.dtypes","user":"anonymous","dateUpdated":"2019-12-09T21:22:26+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[('resident_status', 'string'), ('month_of_death', 'string'), ('sex', 'string'), ('place_of_death_and_decedents_status', 'string'), ('marital_status', 'string'), ('day_of_week_of_death', 'string'), ('injury_at_work', 'string'), ('manner_of_death', 'string'), ('method_of_disposition', 'string'), ('autopsy', 'string'), ('39_cause_recode', 'string'), ('race', 'string'), ('education', 'string'), ('age', 'float')]\n"}]},"apps":[],"jobName":"paragraph_1575926322818_-489328017","id":"20191208-022520_1906936978","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:22:26+0000","dateFinished":"2019-12-09T21:22:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25099"},{"text":"%spark.pyspark\n\narushi.show(3)","user":"anonymous","dateUpdated":"2019-12-09T21:23:29+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------+--------------+---+-----------------------------------+--------------+--------------------+--------------+---------------+---------------------+-------+---------------+----+---------+------+\n|resident_status|month_of_death|sex|place_of_death_and_decedents_status|marital_status|day_of_week_of_death|injury_at_work|manner_of_death|method_of_disposition|autopsy|39_cause_recode|race|education|   age|\n+---------------+--------------+---+-----------------------------------+--------------+--------------------+--------------+---------------+---------------------+-------+---------------+----+---------+------+\n|              1|            01|  M|                                  4|             M|                   4|             U|              7|                    C|      N|             24|  01|        2|1044.0|\n|              1|            01|  M|                                  4|             D|                   3|             U|              7|                    C|      N|             21|  01|        2| 696.0|\n|              1|            01|  F|                                  4|             W|                   2|             U|              7|                    C|      N|             28|  01|        7| 900.0|\n+---------------+--------------+---+-----------------------------------+--------------+--------------------+--------------+---------------+---------------------+-------+---------------+----+---------+------+\nonly showing top 3 rows\n\n"}]},"apps":[],"jobName":"paragraph_1575926322818_-1092695800","id":"20191208-022530_75322269","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:23:29+0000","dateFinished":"2019-12-09T21:23:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25100"},{"text":"%spark.pyspark\n\ncategorical_columns = ['resident_status', 'month_of_death', 'sex', 'place_of_death_and_decedents_status', 'marital_status', \\\n                        'day_of_week_of_death', 'injury_at_work', 'manner_of_death', 'autopsy', '39_cause_recode', \\\n                        'race', 'education']\nnumeric_columns = ['age']\n\ndata_transformation = []\n\nfor column in categorical_columns :\n    \n    stringIndexer = StringIndexer(inputCol = column, outputCol = column + '_index')\n    encoder = OneHotEncoderEstimator(inputCols=[stringIndexer.getOutputCol()], outputCols = [column + \"_vec\"])\n    data_transformation += [stringIndexer, encoder]\n","user":"anonymous","dateUpdated":"2019-12-09T21:23:38+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322818_-234658042","id":"20191209-005252_745358642","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:23:38+0000","dateFinished":"2019-12-09T21:23:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25101"},{"text":"%spark.pyspark\n\nlabel = StringIndexer(inputCol = 'method_of_disposition', outputCol = 'label')\ndata_transformation += [label]","user":"anonymous","dateUpdated":"2019-12-09T21:23:41+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322818_-1184120082","id":"20191209-010649_1514882986","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:23:41+0000","dateFinished":"2019-12-09T21:23:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25102"},{"text":"%spark.pyspark\n\nassembler_inputs = [column + \"_vec\" for column in categorical_columns] + numeric_columns\nassembler = VectorAssembler(inputCols = assembler_inputs, outputCol = \"features\")\ndata_transformation += [assembler]","user":"anonymous","dateUpdated":"2019-12-09T21:23:43+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322819_1043820847","id":"20191209-010833_1764337283","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:23:43+0000","dateFinished":"2019-12-09T21:23:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25103"},{"text":"%spark.pyspark\n\npipeline = Pipeline(stages = data_transformation)\npipelineModel = pipeline.fit(arushi)\ndata = pipelineModel.transform(arushi)","user":"anonymous","dateUpdated":"2019-12-09T21:23:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322819_-2018266323","id":"20191209-012710_750140475","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:23:46+0000","dateFinished":"2019-12-09T21:24:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25104"},{"text":"%spark.pyspark\n\naru_train, aru_test = data.randomSplit([0.7, 0.3])\n","user":"anonymous","dateUpdated":"2019-12-09T21:24:33+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322820_-926492828","id":"20191208-020239_393565412","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T21:24:33+0000","dateFinished":"2019-12-09T21:24:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25105"},{"text":"%spark.pyspark\n\nlogreg = LogisticRegression(featuresCol = 'features', labelCol = 'label', maxIter=10)\nlogreg_model = logreg.fit(aru_train)","user":"anonymous","dateUpdated":"2019-12-10T02:59:28+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322820_1795232400","id":"20191209-020810_624433157","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-10T02:59:28+0000","dateFinished":"2019-12-10T03:00:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25106"},{"text":"%spark.pyspark\n\ntrain_pred = logreg_model.transform(aru_train)\ntrain_pred.select('method_of_disposition', 'label', 'rawPrediction', 'prediction', 'probability').show(10)","user":"anonymous","dateUpdated":"2019-12-10T03:23:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------+-----+--------------------+----------+--------------------+\n|method_of_disposition|label|       rawPrediction|prediction|         probability|\n+---------------------+-----+--------------------+----------+--------------------+\n|                    B|  0.0|[-0.6854740219368...|       1.0|[0.33504065474181...|\n|                    B|  0.0|[-0.6718196708966...|       1.0|[0.33808950586203...|\n|                    C|  1.0|[-0.5548772144326...|       1.0|[0.36473359998908...|\n|                    B|  0.0|[0.46177050502720...|       0.0|[0.61343410501055...|\n|                    B|  0.0|[-1.1877912612595...|       1.0|[0.23365419965197...|\n|                    B|  0.0|[-1.0054968640874...|       1.0|[0.26786204592499...|\n|                    B|  0.0|[0.11826894336637...|       0.0|[0.52953281956556...|\n|                    B|  0.0|[-0.6275255522938...|       1.0|[0.34807182281370...|\n|                    B|  0.0|[-0.7708050310087...|       1.0|[0.31630498762390...|\n|                    B|  0.0|[0.08233468699467...|       0.0|[0.52057205156552...|\n+---------------------+-----+--------------------+----------+--------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1575941087166_-2123125719","id":"20191210-012447_247993450","dateCreated":"2019-12-10T01:24:47+0000","dateStarted":"2019-12-10T03:23:18+0000","dateFinished":"2019-12-10T03:24:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25107"},{"text":"%spark.pyspark\n\nevaluator = BinaryClassificationEvaluator()\nevaluator.evaluate(train_pred)","user":"anonymous","dateUpdated":"2019-12-10T03:23:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.6720411635311261\n"}]},"apps":[],"jobName":"paragraph_1575941114792_178914805","id":"20191210-012514_2084549044","dateCreated":"2019-12-10T01:25:14+0000","dateStarted":"2019-12-10T03:23:20+0000","dateFinished":"2019-12-10T03:24:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25108"},{"text":"%spark.pyspark\n\ntest_pred = logreg_model.transform(aru_test)\ntest_pred_results = test_pred.select('method_of_disposition', 'label', 'rawPrediction', 'prediction', 'probability')","user":"anonymous","dateUpdated":"2019-12-10T03:23:32+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322820_1004501480","id":"20191209-020934_449023604","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-10T03:00:44+0000","dateFinished":"2019-12-10T03:01:21+0000","status":"ABORT","progressUpdateIntervalMs":500,"$$hashKey":"object:25109"},{"text":"%spark.pyspark\n\nevaluator = BinaryClassificationEvaluator()\nevaluator.evaluate(test_pred)","user":"anonymous","dateUpdated":"2019-12-10T03:23:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.6658560818028214\n"}]},"apps":[],"jobName":"paragraph_1575926322820_2095932114","id":"20191209-022646_1779433540","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-10T03:24:00+0000","dateFinished":"2019-12-10T03:25:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25110"},{"text":"%spark.pyspark\n\ntp = test_pred_results.where((test_pred_results.prediction == 1.0) & (test_pred_results.label == 1.0)).count()\ntn = test_pred_results.where((test_pred_results.prediction == 0.0) & (test_pred_results.label == 0.0)).count()\n\nfp = test_pred_results.where((test_pred_results.prediction == 1.0) & (test_pred_results.label == 0.0)).count()\nfn = test_pred_results.where((test_pred_results.prediction == 0.0) & (test_pred_results.label == 1.0)).count()\n\nprint tp\nprint tn\nprint fp\nprint fn\n","user":"anonymous","dateUpdated":"2019-12-10T03:23:43+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"176259\n245884\n102831\n151680\n"}]},"apps":[],"jobName":"paragraph_1575944524162_-2012230357","id":"20191210-022204_237894481","dateCreated":"2019-12-10T02:22:04+0000","dateStarted":"2019-12-10T03:24:41+0000","dateFinished":"2019-12-10T03:26:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25111"},{"text":"%spark.pyspark\n\n%spark.pyspark\n\na = tp + tn\nb = tp + tn + fp+fn\nprint a\nprint b","user":"anonymous","dateUpdated":"2019-12-10T03:23:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-2424729224577032349.py\", line 364, in <module>\n    code = compile('\\n'.join(stmts), '<stdin>', 'exec', ast.PyCF_ONLY_AST, 1)\n  File \"<stdin>\", line 1\n    %spark.pyspark\n    ^\nSyntaxError: invalid syntax\n"}]},"apps":[],"jobName":"paragraph_1575948188101_-1771083877","id":"20191210-032308_498887136","dateCreated":"2019-12-10T03:23:08+0000","dateStarted":"2019-12-10T03:25:17+0000","dateFinished":"2019-12-10T03:26:31+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:25112"},{"text":"%spark.pyspark\n\nrf = RandomForestClassifier(labelCol = \"label\", featuresCol = \"features\", numTrees = 100)\nrf_model = rf.fit(aru_train)","user":"anonymous","dateUpdated":"2019-12-10T02:38:19+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322821_-921849725","id":"20191209-024529_186296923","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-10T02:38:19+0000","dateFinished":"2019-12-10T02:41:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25113"},{"text":"%spark.pyspark\n\ntrain_pred = rf_model.transform(aru_train)\ntrain_pred.select('method_of_disposition', 'label', 'rawPrediction', 'prediction', 'probability').show(10)","user":"anonymous","dateUpdated":"2019-12-10T03:10:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------+-----+--------------------+----------+--------------------+\n|method_of_disposition|label|       rawPrediction|prediction|         probability|\n+---------------------+-----+--------------------+----------+--------------------+\n|                    B|  0.0|[39.9191106935887...|       1.0|[0.39919110693588...|\n|                    B|  0.0|[40.8467548776074...|       1.0|[0.40846754877607...|\n|                    C|  1.0|[46.4329263517950...|       1.0|[0.46432926351795...|\n|                    B|  0.0|[57.9376664924295...|       0.0|[0.57937666492429...|\n|                    B|  0.0|[40.2880828206102...|       1.0|[0.40288082820610...|\n|                    B|  0.0|[41.4123158532085...|       1.0|[0.41412315853208...|\n|                    B|  0.0|[54.5920348563601...|       0.0|[0.54592034856360...|\n|                    B|  0.0|[41.6571906616777...|       1.0|[0.41657190661677...|\n|                    B|  0.0|[41.3181927846159...|       1.0|[0.41318192784615...|\n|                    B|  0.0|[55.2424775509849...|       0.0|[0.55242477550984...|\n+---------------------+-----+--------------------+----------+--------------------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1575941361661_1538927524","id":"20191210-012921_1599601452","dateCreated":"2019-12-10T01:29:21+0000","dateStarted":"2019-12-10T03:10:48+0000","dateFinished":"2019-12-10T03:11:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25114"},{"text":"%spark.pyspark\n\nevaluator = BinaryClassificationEvaluator()\nevaluator.evaluate(train_pred)","user":"anonymous","dateUpdated":"2019-12-10T03:10:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.6659891005927203\n"}]},"apps":[],"jobName":"paragraph_1575941400205_261478464","id":"20191210-013000_1390221906","dateCreated":"2019-12-10T01:30:00+0000","dateStarted":"2019-12-10T03:10:51+0000","dateFinished":"2019-12-10T03:12:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25115"},{"text":"%spark.pyspark\n\n# test_pred = rf_model.transform(aru_test)\ntest_pred_results = test_pred.select('method_of_disposition', 'label', 'rawPrediction', 'prediction', 'probability')","user":"anonymous","dateUpdated":"2019-12-10T03:15:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322821_816527408","id":"20191209-024726_34877333","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-10T03:15:39+0000","dateFinished":"2019-12-10T03:15:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25116"},{"text":"%spark.pyspark\n\nevaluator = BinaryClassificationEvaluator()\nevaluator.evaluate(test_pred)","user":"anonymous","dateUpdated":"2019-12-10T03:11:05+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0.6658560818028255\n"}]},"apps":[],"jobName":"paragraph_1575926322821_-397297069","id":"20191209-024747_576122934","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-10T03:12:20+0000","dateFinished":"2019-12-10T03:13:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25117"},{"text":"%spark.pyspark\n\ntp = test_pred_results.where((test_pred_results.prediction == 1.0) & (test_pred_results.label == 1.0)).count()\ntn = test_pred_results.where((test_pred_results.prediction == 0.0) & (test_pred_results.label == 0.0)).count()\n\nfp = test_pred_results.where((test_pred_results.prediction == 1.0) & (test_pred_results.label == 0.0)).count()\nfn = test_pred_results.where((test_pred_results.prediction == 0.0) & (test_pred_results.label == 1.0)).count()\n\nprint tp\nprint tn\nprint fp\nprint fn\n","user":"anonymous","dateUpdated":"2019-12-10T03:15:45+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"176154\n245645\n102933\n151991\n"}]},"apps":[],"jobName":"paragraph_1575944466638_-2096242189","id":"20191210-022106_993930921","dateCreated":"2019-12-10T02:21:06+0000","dateStarted":"2019-12-10T03:15:45+0000","dateFinished":"2019-12-10T03:18:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25118"},{"text":"%spark.pyspark\n\na = tp + tn\nb = tp + tn + fp+fn\nprint a\nprint b","user":"anonymous","dateUpdated":"2019-12-10T03:22:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"421799\n676723\n"}]},"apps":[],"jobName":"paragraph_1575947976691_-647267173","id":"20191210-031936_326891158","dateCreated":"2019-12-10T03:19:36+0000","dateStarted":"2019-12-10T03:21:55+0000","dateFinished":"2019-12-10T03:21:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25119"},{"text":"%spark.pyspark\n\nvariables = []\n\nfor row in data.schema[\"features\"].metadata[\"ml_attr\"][\"attrs\"][\"binary\"] :\n    # var_row = data.schema[\"features\"].metadata[\"ml_attr\"][\"attrs\"][i]\n    variables.append((row[\"idx\"], row[\"name\"]))\n\nfor row in data.schema[\"features\"].metadata[\"ml_attr\"][\"attrs\"][\"numeric\"] :\n    # var_row = data.schema[\"features\"].metadata[\"ml_attr\"][\"attrs\"][i]\n    variables.append((row[\"idx\"], row[\"name\"]))","user":"anonymous","dateUpdated":"2019-12-09T23:27:23+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575926322821_645152643","id":"20191209-024529_2025616711","dateCreated":"2019-12-09T21:18:42+0000","dateStarted":"2019-12-09T23:27:23+0000","dateFinished":"2019-12-09T23:27:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25120"},{"text":"%spark.pyspark\n\nfeature_imp = []\nscores = list(rf_model.featureImportances)\n\nfor var, score in zip(variables, scores):\n    feature_imp.append(var + (score,))\n","user":"anonymous","dateUpdated":"2019-12-09T23:38:22+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575932281983_-2134453345","id":"20191209-225801_99196079","dateCreated":"2019-12-09T22:58:01+0000","dateStarted":"2019-12-09T23:38:23+0000","dateFinished":"2019-12-09T23:38:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25121"},{"text":"%spark.pyspark\n\n# sc = SparkContext()\nrdd = sc.parallelize(feature_imp)\nfeature_imp = rdd.map(lambda x: Row(index = x[0], name = x[1], importance = float(x[2])))\nfeature_importance = sqlContext.createDataFrame(feature_imp)\nfeature_importance = feature_importance.sort(desc(\"importance\"))\n","user":"anonymous","dateUpdated":"2019-12-09T23:38:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1575932056757_998695002","id":"20191209-225416_813969360","dateCreated":"2019-12-09T22:54:16+0000","dateStarted":"2019-12-09T23:38:27+0000","dateFinished":"2019-12-09T23:38:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25122"},{"text":"%spark.pyspark\n\nfeature_importance.collect()[9][2]","user":"anonymous","dateUpdated":"2019-12-10T02:54:33+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"u'manner_of_death_vec_99'\n"}]},"apps":[],"jobName":"paragraph_1575933120537_-1443204142","id":"20191209-231200_797554473","dateCreated":"2019-12-09T23:12:00+0000","dateStarted":"2019-12-10T02:54:22+0000","dateFinished":"2019-12-10T02:54:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:25123"},{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2019-12-09T21:18:42+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575926322822_187534687","id":"20191209-024528_657071466","dateCreated":"2019-12-09T21:18:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25124"},{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2019-12-09T21:18:42+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1575926322822_-304802064","id":"20191209-021145_406827794","dateCreated":"2019-12-09T21:18:42+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25125"}],"name":"Arushi 12-9","id":"2EUS3FGZ3","noteParams":{},"noteForms":{},"angularObjects":{"python:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}